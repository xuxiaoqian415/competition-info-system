<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.info.competition.dao.CompetitionDao">

    <sql id="Base_Column_List">
        id,`cp_name`,`cp_content`,apply_start,apply_end,cp_start,cp_end
    </sql>

    <select id="getCompetitionList" resultType="Competition" parameterType="Query">
        select
        <include refid="Base_Column_List" />
        from competition
        <where>
            <if test="startTime != null and startTime != ''">
                apply_end &gt;= #{startTime}
            </if>
            <if test="endTime != null and startTime != ''">
                apply_end &lt;= #{endTime}
            </if>
            <if test="keyword != null and keyword != ''">
                <bind name="_keyword" value="'%' + keyword + '%'"/>
                AND (cp_name LIKE #{_keyword} or cp_content LIKE #{_keyword})
            </if>
        </where>
    </select>

    <select id="getCompetitionByApply" resultType="Competition">
        select
        <include refid="Base_Column_List" />
        from competition
        where apply_start &lt;= #{currentTime}
          and apply_end &gt;= #{currentTime}
    </select>

    <insert id="addCompetition" parameterType="Competition">
        insert into competition(cp_name,cp_content,apply_start,apply_end,cp_start,cp_end)
        values(#{cpName},#{cpContent},#{applyStart},#{applyEnd},#{cpStart},#{cpEnd})
    </insert>

    <select id="getCompetitionDetail" parameterType="int" resultType="Competition">
        select
        <include refid="Base_Column_List" />
        from competition
        where id = #{id}
    </select>

</mapper>